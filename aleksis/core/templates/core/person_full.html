{# -*- engine:django -*- #}

{% extends "core/base.html" %}

{% load i18n static cropping rules %}
{% load render_table from django_tables2 %}

{% block browser_title %}{{ person.first_name }} {{ person.last_name }}{% endblock %}

{% block content %}
  <h4>{{ person.first_name }} {{ person.last_name }}</h4>

  {% has_perm 'core.change_person' user person as can_change_person %}
  {% if can_change_person %}
    <p>
      <a href="{% url 'edit_person_by_id' person.id %}" class="btn waves-effect waves-light">
        <i class="material-icons left">edit</i>
        {% trans "Edit" %}
      </a>
    </p>
  {% endif %}

  <h5>{% blocktrans %}Contact details{% endblocktrans %}</h5>
  <div class="row">
    <div class="col s12 m4">
      {% has_perm 'core.view_photo' user person as can_view_photo %}
      {% if person.photo and can_view_photo %}
        <img class="person-img" src="{% cropped_thumbnail person 'photo_cropping' max_size='300x400' %}"
             alt="{{ person.first_name }} {{ person.last_name }}"/>
      {% else %}
        <img class="person-img" src="{% static 'img/fallback.png' %}"
             alt="{{ person.first_name }} {{ person.last_name }}"/>
      {% endif %}
    </div>
    <div class="col s12 m8">
      <table class="table table-responsive-xl table-border table-striped">
        <tr>
          <td rowspan="6">

          </td>
          <td>
            <i class="material-icons small">person</i>
          </td>
          <td>{{ person.first_name }}</td>
          <td>{{ person.additional_name }}</td>
          <td>{{ person.last_name }}</td>
        </tr>
        <tr>
          <td>
            <i class="material-icons small">face</i>
          </td>
          <td colspan="3">{{ person.get_sex_display }}</td>
        </tr>
        {% has_perm 'core.view_address' user person as can_view_address %}
        {% if can_view_address %}
          <tr>
            <td>
              <i class="material-icons small">home</i>
            </td>
            <td colspan="2">{{ person.street }} {{ person.housenumber }}</td>
            <td colspan="2">{{ person.postal_code }} {{ person.place }}</td>
          </tr>
        {% endif %}
        {% has_perm 'core.view_contact_details' user person as can_view_contact_details %}
        {% if can_view_contact_details %}
          <tr>
            <td>
              <i class="material-icons small">phone</i>
            </td>
            <td>{{ person.phone_number }}</td>
            <td>{{ person.mobile_number }}</td>
          </tr>
          <tr>
            <td>
              <i class="material-icons small">email</i>
            </td>
            <td colspan="3">{{ person.email }}</td>
          </tr>
        {% endif %}
        <tr>
          <td>
            <i class="material-icons small">cake</i>
          </td>
          <td colspan="3">{{ person.date_of_birth|date }}</td>
        </tr>
      </table>
    </div>
  </div>

  {% has_perm 'core.view_person_groups' user person as can_view_groups %}
  {% if can_view_groups %}
    <h5>{% blocktrans %}Groups{% endblocktrans %}</h5>
    {% render_table groups_table %}
  {% endif %}
{% endblock %}
